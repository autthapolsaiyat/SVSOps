:80 {
	encode zstd gzip

	route {
		# ---- API (คง prefix /api) ----
		@api path /api/*
		handle @api {
			request_body { max_size 0 }
			reverse_proxy backend:8080 {
				header_up Authorization {>Authorization}
				header_up X-Forwarded-Host {host}
				header_up X-Forwarded-Proto {scheme}
				header_up X-Forwarded-For {remote}
			}
		}

		# ---- Frontend (SPA) ----
		handle {
			root * /srv
			try_files {path} /index.html
			file_server
		}
	}
}

